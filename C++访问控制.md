# C++ 访问控制

## 访问控制与封装

1. 在 C++ 中，使用**访问说明符**来加强类的封装性：
   * `public` ：在整个程序类中可以访问。
   * `private` ：可以被类的成员函数访问，但是不能被使用该类的代码访问。
   * `protect`：
     * 和私有成员类似，受保护的成员对于类的用户来说是不可访问的
     * 和公有成员类似，受保护的成员对于派生类的成员和友元来说是可访问的
     * 派生类的成员或友元只能通过派生类对象来访问基类的受保护成员。派生类对于一个基类对象中的受保护成员没有任何访问特权。
       ![image-20250221214237154](.\img\image-20250221214237154.png)
2. 友元：
   * 允许其他类或者函数访问它的非公有成员，在函数声明语句中加入 `friend` 关键字。
   * 友元声明只能出现在类定义的内部，但是在类内出现的具体位置不限。
   * 友元的声明仅仅指定了访问的权限，而非一个通常意义上的函数声明。如果我们希望类的用户能够调用某个友元函数，那么我们就必须在友元声明之外再专门对函数进行一次声明。
   * 友元函数能定义在类的内部，这样的函数是隐式内联的。

## 访问控制与继承

1. 派生类可以继承定义在基类中的成员，但是派生类的成员函数不一定有权访问从基类继承而来的成员。
2. 尽管在派生类对象中含有从基类继承而来的成员，但是派生类并不能直接初始化这些成员。和其他创建了基类对象的代码一样，派生类也必须使用基类的构造函数来初始化它的基类部分。**每个类控制它自己的成员初始化过程。**
3. **每个类还分别控制着其成员对于派生类来说是否可访问**。
4. 某个类对继承而来的成员的访问权限受两个因素影响：
   * 基类中该成员的访问说明符
   * 派生类的派生列表中的访问说明符
5. 派生访问说明符对于派生类的成员（及友元）能否访问其直接基类的成员没什么影响。**派生访问说明符的目的是控制派生类用户（包括派生类的派生类在内）对于基类成员的访问权限**。
6. 总结一下，也就是不管采用什么方式继承，派生类都可以访问基类的 `public` 和 `private` 成员，而不同的访问说明符规定了派生类对象对基类成员的访问权限，以及派生类的派生类对于基类成员的访问权限。
   其实相当于基类的那些成员如果写在派生类下面应该是什么访问控制：
   * public继承：基类是什么样，派生类就是什么样
   * protect继承：基类的public变成protect
   * private继承：基类中的一切都变成private

